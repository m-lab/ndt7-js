language: node_js

node_js:
- 12

# Required by TestCafe.
before_install:
   - stty cols 80

addons:
   firefox: latest
   chrome: stable
   browserstack:
      username:
         secure: "WI1723Yel0RzjG6nUvBUEgltAGeiKoDwgbMdjd0wonsCMLIGbvO3/Xqw25UU2jgh7QU03gNMN30FJWWJLeohptdo+DnlX9cv6xcA42yPWT2xyFgtVel2BQMJUCQR52Z20HfFI3zcY6ESIjBnlQes9VtTh6mfYzsHjPys4lblzOtJtAgSWZ25WrEoA196STstJybp2+TDYHaXw3fJ1hbmAAee/pBIos9h9HvMJsHHh8wKBe3FguZJUew4NTGBr2u9w0cTrKiWnkt4zSku0ZZvye+Nk6LG77CsoVEPyrK5dtHAJYTjwQbdcMzKiylpYxR7rNgpRKOFSk5ISuJkYkO5wNBqHh2eyqu6Y0CgyqI4kprSnV70Onz6mif7Sq3EjWd1Dkhzi208f5Xyz0a58bNHIkqt1jKI2VHOhjMSrNZ+XZSvekumhhUM46Euacbs+eSEuWpjCxbJ+amfxquuJMEmKxhGedXYm+8jIAlaoAb/qFUsnmbPIuwZIfm7RWZ2FG10zSDdxwCCCKQ9dQnnwHupvwUR8/2cAYwdhtUj/3ZwnOe00N3+j5uUS3w8x2YeI6LaxUx/6L544YN633EAy10gXtFUR6B6dCM8y/8fQdKvPxAgdpwiO+5znoCXU+e3t43UVTIZSwVQEJkwD7oy0EyzsSvxHFQeYUhiN1p/XCdrN6I="
      access_key:
         secure: "E8j9zprmgwlf1hsxwhF5utQq4Jss1QkDgTAe9/lzsZhVgjKfZUaSruiLmxFcpBXor5vE1xqhgPQaQ1PCpxdEFQ+BaVyZv8gSwfDr3giPYI5q9DcsrU+y/+FlOa/0kSB4rUn/0NiTsE7K+MbU90QDd9uP3Z2khShswwgsyWD6VHIzt/eVFsAzZ6e+C+MUdaOx7SFPK/Ve7giqiJyi5Suhz2hv0Ssy41VUlx5A/+xah5F7JDa4Ta3q6IqScyHibW2Jx8VDGN+c7S/5460f7XBgdln0DeWouCZASVBKI0YrinDTelWMf/XdaXnByqqdpncE/ENc18MgB+HA4YRPL+Z9QIlvDupt8kwVJqRPfCJ86ntxQcBze8jJ5gQS3ghjxxgE2pdP4/IdXkHDOhQOGpDbteZ2QeqIxb0djRxj/V/Es1/PNCInXFiguARme4Np7oFkTM6I4HZ5eTqXHyAaUjm8R3yBd2Sj7KmJIhVpcLUjrOciePorpnrPxbbxP4fdz5iGwWiDWamouHmrJWXzhGdqIZSKxiLV/X6Wf0ZVtkc8E1zXO4f4nalNrZBxpKQwe9DDe3xsxNhurQqRj8XRu9ngtBFTCChYdwj0fP/Sk8gp+p6E+HLvr2yR9JQwgsANZ+pG2K9UkMQKaSiZsinWxZtfiBF0qADx8Qh6riFILurUDJI="

script:
# Coverage runs the tests, so this implies `npm test`
# TODO: upload coverage to coveralls.io
- npm run coverage
# Lint the code. Note that the linter version is saved in
# package-lock.json, which means that eslint on the host and the server
# should be exactly the same.
- npm run lint
# Verify that the things that are compiled and checked in have been
# generated correctly from the most recent sources.
- npm run document && git diff --exit-code README.md
- npm run minify && git diff --exit-code src/ndt7.min.js
- npm run browserstack
# TODO Upload the code to npm after it is tagged.
