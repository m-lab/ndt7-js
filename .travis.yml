version: ~> 1.0
language: node_js

node_js:
- 12

addons:
  firefox: latest
  chrome: stable
  browserstack: true

# Required by TestCafe.
before_install:
- stty cols 80

env:
  global:
  - secure: fpIkM9oq6PzP0gI+U8wsK6d4jOHCRPPXzitpmrtSkwPZwbtQyAv+ngfvHJnC6OQa0rxa/yVFjYoDo5HTahjyfqAooZ4Ra1S6HXrVjaC655TJXa7blyYyqOgQz/l9FHV/HCTmSUKR+N4H2lZhMbaR9LRaIfXHOyZLn5oXxlauNJfb0leYW7ILD/oyAXydc1d34VpCBvUUf0sSXHRGZxkvZnBeTuE9bgOqE8URxBrNbCBJSmS386xBfdbPexiZDBVJXQ3PA1BdSdvDqsGg2wI17HmmC8goqXwrCRyBN6oKknzagpSX9V5iIKVFRYg4rkbvGKzGqdjRt3GEeuz7HmU9JwXU0+SJcPYRsbx/880NPq8LSv4aU52r/9N+gC01CAr+HHGjU3tn3AuZ2jduN3BaUiRfHxsxiIr9dN44SryEBdvUXgtsBorgzDwds7hnvK9vXiAMmgHt7+NuTP9nYinUXOA9mrEPrmivChPy0p2I4R4SbLpSG3bIYDy2/3ZYONsBOLXXrXITpUXtZrw1du5JnvC4C5LQDCyBqDKgBieaH6fBkIw0frxLZNVXnFTZuHM5oyxGqR3lpeJtMjlbZVkMCJY6pNqMDZKDg203NJaLicCLA2MTMz8wJOIMSWwbWgW2PpOAxCwe1a9rkzhmb7UkI6krAU6HeZzhM+kg1JQ97oQ=
  - secure: OVh4OLDbHZ4Ci0k7mn47KEdcRZxhxMD9Id2ht3OkaFlxFN8vctv5KBR7XeJ0LciAIgNYCdtBmZ/nVv7aJ31q6upcHHpotM/9Ls2PZb5CuYWVYPfRkv5I3OQRz0yIhKWCPXPYixwqVfYOQrOrVj675hbYC0bIlL63J2NiM+q9UWiJD6ajyPxixidu1Lh4kmz5diECK/+9WRxYwa/A+b84b04BXQmCd4NlnknM5NvtjB9Aj4cfzt9e/PMMz+t8kvcmzX4P1JZVSrC1qjkhX1MlpQOEZjoVKHqHf6lR5Wa6oXM4CG0kv7qmaSxW5wxFNzUf8BBH7SQU0FXeKE+pveJVs0R0bvw/tCW4xgT77Y1veT251y2rb0MwF5N0+EIld26QGHSAw8FjppAGywu7gDCeC3UGb/k5E9s6nRqPEtUF8BXGf57OF0iMt8uhhvozcd5uRYzQyAySmfwtJ3MSg7yMXYqDllfWoGufaeDen53ZMFHjjKlzwKpNNi7+FuIc0qizKewfIsXLtJnBMUEa6m1kc99B2Ba7brTNP3zKqvJWMTnWRIagbLXkAzRbCp9fkRLk++ZMQOC3DtrgLljAis2qxleDn5LNtKbz8p5dyB+QAr6zVmmEnzELsfwMoqTxF7ZqEZXf0RfglOxI7r6tyGqcdhA6YkClkx7xRU0jW7W4jBo=
script:
# Coverage runs the tests, so this implies `npm test`
# TODO: upload coverage to coveralls.io
- npm run coverage
# Lint the code. Note that the linter version is saved in
# package-lock.json, which means that eslint on the host and the server
# should be exactly the same.
- npm run lint
# Verify that the things that are compiled and checked in have been
# generated correctly from the most recent sources.
- npm run document && git diff --exit-code README.md
- npm run minify && git diff --exit-code src/ndt7.min.js
- npm run browserstack
# TODO Upload the code to npm after it is tagged.
